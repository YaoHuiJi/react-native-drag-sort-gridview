Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _react=require("react");var _reactNative=require("react-native");var MOVEMENT;(function(MOVEMENT){MOVEMENT[MOVEMENT["restore"]=0]="restore";MOVEMENT[MOVEMENT["prev"]=1]="prev";MOVEMENT[MOVEMENT["next"]=2]="next";})(MOVEMENT||(MOVEMENT={}));var _default=function _default(_ref){var itemWidth=_ref.itemWidth,itemHeight=_ref.itemHeight,numColumns=_ref.numColumns,isEditing=_ref.isEditing,index=_ref.index,dragItemOriginIndex=_ref.dragItemOriginIndex,dragItemTargetIndex=_ref.dragItemTargetIndex,animMoveDuration=_ref.animMoveDuration;var isMoved=(0,_react.useRef)(false);var moveXAnimRef=(0,_react.useRef)(new _reactNative.Animated.Value(0));var moveYAnimRef=(0,_react.useRef)(new _reactNative.Animated.Value(0));var rotateAnim=(0,_react.useRef)(new _reactNative.Animated.Value(0)).current;var movement=(0,_react.useMemo)(function(){if(dragItemOriginIndex===undefined||dragItemTargetIndex===undefined){return MOVEMENT.restore;}if(index===dragItemOriginIndex){return MOVEMENT.restore;}if(dragItemTargetIndex<dragItemOriginIndex){if(index>dragItemOriginIndex){return MOVEMENT.restore;}if(index>=dragItemTargetIndex){return MOVEMENT.next;}}else if(dragItemTargetIndex>dragItemOriginIndex){if(index<dragItemOriginIndex){return MOVEMENT.restore;}if(index<=dragItemTargetIndex){return MOVEMENT.prev;}}return MOVEMENT.restore;},[index,dragItemOriginIndex,dragItemTargetIndex]);var animRef=(0,_react.useRef)(_reactNative.Animated.loop(_reactNative.Animated.sequence([_reactNative.Animated.timing(rotateAnim,{toValue:1,duration:150,easing:_reactNative.Easing.out(_reactNative.Easing.ease),useNativeDriver:true}),_reactNative.Animated.timing(rotateAnim,{toValue:-1,duration:150,easing:_reactNative.Easing.out(_reactNative.Easing.ease),useNativeDriver:true})])));var restore=(0,_react.useCallback)(function(){if(isMoved.current===false){return;}isMoved.current=false;_reactNative.Animated.parallel([_reactNative.Animated.timing(moveXAnimRef.current,{toValue:0,duration:animMoveDuration,useNativeDriver:true,easing:_reactNative.Easing.out(_reactNative.Easing.ease)}),_reactNative.Animated.timing(moveYAnimRef.current,{toValue:0,duration:animMoveDuration,useNativeDriver:true,easing:_reactNative.Easing.out(_reactNative.Easing.ease)})]).start();},[animMoveDuration]);var movePrev=(0,_react.useCallback)(function(){isMoved.current=true;if(index%numColumns===0){_reactNative.Animated.parallel([_reactNative.Animated.timing(moveXAnimRef.current,{toValue:itemWidth*(numColumns-1),duration:animMoveDuration,useNativeDriver:true,easing:_reactNative.Easing.out(_reactNative.Easing.ease)}),_reactNative.Animated.timing(moveYAnimRef.current,{toValue:-itemHeight,duration:animMoveDuration,useNativeDriver:true,easing:_reactNative.Easing.out(_reactNative.Easing.ease)})]).start();}else{_reactNative.Animated.timing(moveXAnimRef.current,{toValue:-itemWidth,duration:animMoveDuration,useNativeDriver:true,easing:_reactNative.Easing.out(_reactNative.Easing.ease)}).start();}},[index,itemWidth,itemHeight,numColumns,animMoveDuration]);var moveNext=(0,_react.useCallback)(function(){isMoved.current=true;if(index%numColumns===numColumns-1){_reactNative.Animated.parallel([_reactNative.Animated.timing(moveXAnimRef.current,{toValue:-itemWidth*(numColumns-1),duration:animMoveDuration,useNativeDriver:true,easing:_reactNative.Easing.out(_reactNative.Easing.ease)}),_reactNative.Animated.timing(moveYAnimRef.current,{toValue:itemHeight,duration:animMoveDuration,useNativeDriver:true,easing:_reactNative.Easing.out(_reactNative.Easing.ease)})]).start();}else{_reactNative.Animated.timing(moveXAnimRef.current,{toValue:itemWidth,duration:animMoveDuration,useNativeDriver:true,easing:_reactNative.Easing.out(_reactNative.Easing.ease)}).start();}},[index,itemWidth,itemHeight,numColumns,animMoveDuration]);var startRotate=(0,_react.useCallback)(function(){animRef.current.reset();animRef.current.start();},[]);var stopRotate=(0,_react.useCallback)(function(){animRef.current.stop();},[]);(0,_react.useEffect)(function(){if(isEditing===true){setTimeout(startRotate,Math.random()*300);}else{stopRotate();rotateAnim.setValue(0);}},[isEditing,rotateAnim,animMoveDuration,startRotate,stopRotate]);(0,_react.useEffect)(function(){switch(movement){case MOVEMENT.restore:restore();break;case MOVEMENT.next:moveNext();break;case MOVEMENT.prev:movePrev();break;}},[movement,moveNext,movePrev,restore]);return{moveXAnim:moveXAnimRef.current,moveYAnim:moveYAnimRef.current,rotateAnim:rotateAnim,startRotate:startRotate};};exports.default=_default;
//# sourceMappingURL=useAnimHooks.js.map