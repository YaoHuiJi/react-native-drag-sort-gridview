Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _react=require("react");var _reactNativeReanimated=require("react-native-reanimated");var MOVEMENT;(function(MOVEMENT){MOVEMENT[MOVEMENT["restore"]=0]="restore";MOVEMENT[MOVEMENT["prev"]=1]="prev";MOVEMENT[MOVEMENT["next"]=2]="next";})(MOVEMENT||(MOVEMENT={}));var _default=function _default(_ref){var itemWidth=_ref.itemWidth,itemHeight=_ref.itemHeight,numColumns=_ref.numColumns,isEditing=_ref.isEditing,isDragging=_ref.isDragging,index=_ref.index,dragItemOriginIndex=_ref.dragItemOriginIndex,dragItemTargetIndex=_ref.dragItemTargetIndex,animMoveDuration=_ref.animMoveDuration;var isMoved=(0,_react.useRef)(false);var movementOffset=(0,_reactNativeReanimated.useSharedValue)({x:0,y:0});var rotationOffset=(0,_reactNativeReanimated.useSharedValue)(0);var animatedStyles=(0,_reactNativeReanimated.useAnimatedStyle)(function(){var _f=function _f(){return{transform:[{translateX:isDragging?movementOffset.value.x:(0,_reactNativeReanimated.withTiming)(movementOffset.value.x,{duration:animMoveDuration,easing:_reactNativeReanimated.Easing.out(_reactNativeReanimated.Easing.exp)})},{translateY:isDragging?movementOffset.value.y:(0,_reactNativeReanimated.withTiming)(movementOffset.value.y,{duration:animMoveDuration,easing:_reactNativeReanimated.Easing.out(_reactNativeReanimated.Easing.exp)})},{rotateZ:`${rotationOffset.value}deg`}]};};_f._closure={isDragging:isDragging,movementOffset:movementOffset,withTiming:_reactNativeReanimated.withTiming,animMoveDuration:animMoveDuration,Easing:{out:_reactNativeReanimated.Easing.out,exp:_reactNativeReanimated.Easing.exp},rotationOffset:rotationOffset};_f.asString="function _f(){const{isDragging,movementOffset,withTiming,animMoveDuration,Easing,rotationOffset}=jsThis._closure;{return{transform:[{translateX:isDragging?movementOffset.value.x:withTiming(movementOffset.value.x,{duration:animMoveDuration,easing:Easing.out(Easing.exp)})},{translateY:isDragging?movementOffset.value.y:withTiming(movementOffset.value.y,{duration:animMoveDuration,easing:Easing.out(Easing.exp)})},{rotateZ:rotationOffset.value+\"deg\"}]};}}";_f.__workletHash=9336928532472;_f.__location="/Users/stanley/rn/module/react-native-drag-sort-gridview/src/components/useReanimHooks.tsx (43:42)";_f.__optimalization=2;return _f;}());var startRotate=(0,_react.useCallback)(function(){rotationOffset.value=(0,_reactNativeReanimated.withSequence)((0,_reactNativeReanimated.withTiming)(-3,{duration:100}),(0,_reactNativeReanimated.withRepeat)((0,_reactNativeReanimated.withTiming)(3,{duration:200,easing:_reactNativeReanimated.Easing.out(_reactNativeReanimated.Easing.ease)}),-1,true));},[rotationOffset]);var stopRotate=(0,_react.useCallback)(function(){if(rotationOffset.value===0){return;}rotationOffset.value=0;},[rotationOffset]);var movement=(0,_react.useMemo)(function(){if(dragItemOriginIndex===undefined||dragItemTargetIndex===undefined){return MOVEMENT.restore;}if(dragItemTargetIndex<dragItemOriginIndex){if(index>dragItemOriginIndex){return MOVEMENT.restore;}if(index>=dragItemTargetIndex){return MOVEMENT.next;}}else if(dragItemTargetIndex>dragItemOriginIndex){if(index<dragItemOriginIndex){return MOVEMENT.restore;}if(index<=dragItemTargetIndex){return MOVEMENT.prev;}}return MOVEMENT.restore;},[index,dragItemOriginIndex,dragItemTargetIndex]);var restore=(0,_react.useCallback)(function(){if(isMoved.current===false){return;}isMoved.current=false;movementOffset.value={x:0,y:0};},[movementOffset]);var movePrev=(0,_react.useCallback)(function(){isMoved.current=true;if(index%numColumns===0){movementOffset.value={x:itemWidth*(numColumns-1),y:-itemHeight};}else{movementOffset.value={x:-itemWidth,y:0};}},[index,itemWidth,itemHeight,numColumns,movementOffset]);var moveNext=(0,_react.useCallback)(function(){isMoved.current=true;if(index%numColumns===numColumns-1){movementOffset.value={x:-itemWidth*(numColumns-1),y:itemHeight};}else{movementOffset.value={x:itemWidth,y:0};}},[index,itemWidth,itemHeight,numColumns,movementOffset]);(0,_react.useEffect)(function(){if(isEditing===true){setTimeout(startRotate,Math.random()*300);}else{stopRotate();}},[isEditing,movementOffset,startRotate,stopRotate]);(0,_react.useEffect)(function(){if(isDragging||!isEditing){return;}switch(movement){case MOVEMENT.restore:restore();break;case MOVEMENT.next:moveNext();break;case MOVEMENT.prev:movePrev();break;}},[isDragging,isEditing,movement,moveNext,movePrev,restore]);return{movementOffset:movementOffset,animatedStyles:animatedStyles};};exports.default=_default;
//# sourceMappingURL=useReanimHooks.js.map